<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© | Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙˆÙƒÙ…Ø©</title>
    
    <link rel="icon" type="image/png" href="assets/icons/favicon.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&display=swap');
        * { font-family: 'Cairo', sans-serif; margin: 0; padding: 0; box-sizing: border-box; }
        
        body { background-color: #f8fafc; padding-bottom: 80px; }

        /* 1. Header (Uniform) */
        .header-bg {
            background: linear-gradient(135deg, #0f766e 0%, #115e59 100%);
            padding: 1rem 1.5rem 4rem;
            color: white;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            position: relative;
            z-index: 10;
        }

        .logo-circle-small {
            width: 50px; height: 50px; background: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 2px solid rgba(255,255,255,0.8);
        }

        /* 2. Admin Container (The White Box) */
        .admin-container {
            background: white; border-radius: 20px; padding: 1.5rem;
            margin: -3rem 1rem 1.5rem; position: relative; z-index: 20;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.08); border: 1px solid #e2e8f0;
        }

        /* 3. Tabs Navigation */
        .tabs-nav {
            display: flex; background: #f1f5f9; padding: 4px; border-radius: 12px; margin-bottom: 20px;
        }
        .tab-btn {
            flex: 1; padding: 10px; text-align: center; font-size: 0.85rem; font-weight: 700;
            color: #64748b; border-radius: 10px; transition: 0.2s;
        }
        .tab-btn.active { background: white; color: #0f766e; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Form Elements */
        .form-label { font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 4px; display: block; }
        .form-input {
            width: 100%; padding: 10px 12px; border: 1px solid #e2e8f0; border-radius: 10px;
            font-size: 0.9rem; outline: none; background-color: #f8fafc; transition: 0.2s;
        }
        .form-input:focus { border-color: #0f766e; background: white; }

        .btn-submit {
            background: #0f766e; color: white; width: 100%; padding: 12px;
            border-radius: 12px; font-weight: 700; margin-top: 1rem;
            display: flex; justify-content: center; align-items: center; gap: 8px;
        }
        .btn-submit:hover { background: #115e59; }

        /* Table */
        .monitor-table th { text-align: right; padding: 10px; font-size: 0.75rem; color: #94a3b8; background: #f8fafc; }
        .monitor-table td { padding: 10px; font-size: 0.85rem; border-bottom: 1px solid #f1f5f9; }

        /* Sidebar & Nav (Standard) */
        .sidebar {
            position: fixed; right: 0; top: 0; height: 100vh; width: 260px;
            background: white; border-left: 1px solid #e2e8f0; z-index: 50; transition: transform 0.3s;
        }
        .nav-item { display: flex; align-items: center; gap: 10px; padding: 12px 20px; color: #64748b; font-weight: 600; text-decoration: none; }
        .nav-item:hover { background: #f0fdfa; color: #0f766e; }
        .nav-item.active { background: linear-gradient(135deg, #0f766e, #115e59); color: white; }

        .bottom-nav {
            position: fixed; bottom: 0; width: 100%; background: white;
            border-top: 1px solid #e2e8f0; padding: 10px; z-index: 40;
            display: flex; justify-content: space-around;
        }
        .b-nav-item { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #94a3b8; gap: 4px; text-decoration: none;}
        .b-nav-item.active { color: #0f766e; font-weight: bold; }

        @media (min-width: 1025px) {
            .main-content { margin-right: 260px; padding: 20px; }
            .mobile-header { display: none; }
            .bottom-nav { display: none; }
            .header-bg { display: none; }
            .admin-container { margin: 0; }
        }
        @media (max-width: 1024px) { .sidebar { transform: translateX(100%); } }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="p-6 text-center border-b border-gray-100">
            <div class="w-16 h-16 mx-auto mb-2 bg-white rounded-full flex items-center justify-center border-2 border-teal-50 shadow-sm overflow-hidden p-1">
                <img src="assets/icons/favicon.png" class="w-full h-full object-contain">
            </div>
            <h2 class="font-bold text-slate-800">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙˆÙƒÙ…Ø©</h2>
        </div>
        <nav class="mt-4 px-2">
            <a href="distribution.html" class="nav-item">
                <i data-lucide="bar-chart-2" class="w-5 h-5"></i> Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            </a>
            <a href="admin.html" class="nav-item active">
                <i data-lucide="settings-2" class="w-5 h-5"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            </a>
            <a href="coordinator.html" class="nav-item">
                <i data-lucide="users" class="w-5 h-5"></i> Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
            </a>
            <a href="employee.html" class="nav-item">
                <i data-lucide="briefcase" class="w-5 h-5"></i> Ù…Ù‡Ø§Ù…ÙŠ
            </a>
            <div class="h-px bg-gray-200 my-3"></div>
            <button onclick="auth.logout()" class="nav-item w-full text-red-500 hover:bg-red-50 rounded-lg">
                <i data-lucide="log-out" class="w-5 h-5"></i> ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
            </button>
        </nav>
    </aside>

    <div class="main-content">
        
        <div class="header-bg lg:hidden">
            <div class="flex justify-between items-center mb-1">
                <div class="flex items-center gap-3">
                    <div class="logo-circle-small"><img src="assets/icons/favicon.png" class="w-8 h-8 object-contain"></div>
                    <div>
                        <p class="text-teal-100 text-[11px] font-bold">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
                        <h1 class="font-bold text-xl text-white" id="admin-name">...</h1>
                    </div>
                </div>
                <button onclick="auth.logout()" class="bg-white/20 p-2.5 rounded-xl backdrop-blur-sm hover:bg-red-500 transition">
                    <i data-lucide="log-out" class="w-5 h-5 text-white"></i>
                </button>
            </div>
        </div>

        <div class="admin-container">
            
            <div class="tabs-nav">
                <button onclick="switchTab('new')" class="tab-btn active" id="btn-new">Ø¥Ø¶Ø§ÙØ© ØªÙƒÙ„ÙŠÙ</button>
                <button onclick="switchTab('reassign')" class="tab-btn" id="btn-reassign">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡</button>
                <button onclick="switchTab('monitor')" class="tab-btn" id="btn-monitor">Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</button>
            </div>

            <div id="tab-new" class="tab-content active">
                <form onsubmit="addTask(event)" class="space-y-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</label>
                            <select id="n-type" class="form-input" onchange="toggleLegal()">
                                <option value="ÙˆØ§Ø±Ø¯">ÙˆØ§Ø±Ø¯</option>
                                <option value="ØµØ§Ø¯Ø±">ØµØ§Ø¯Ø±</option>
                                <option value="Ù†ÙŠØ§Ø¨Ø©">Ù†ÙŠØ§Ø¨Ø©</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</label>
                            <select id="n-imp" class="form-input">
                                <option value="Ø¹Ø§Ø¯ÙŠ">Ø¹Ø§Ø¯ÙŠ</option>
                                <option value="Ø¹Ø§Ø¬Ù„">Ø¹Ø§Ø¬Ù„ ğŸ”¥</option>
                                <option value="Ø¹Ø§Ø¬Ù„ Ø¬Ø¯Ø§">Ø¹Ø§Ø¬Ù„ Ø¬Ø¯Ø§Ù‹ ğŸš¨</option>
                            </select>
                        </div>
                    </div>

                    <div id="legal-box" class="hidden bg-orange-50 border border-orange-100 p-3 rounded-xl grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-[10px] font-bold text-orange-500 block mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ©</label>
                            <input type="text" id="n-case" class="form-input bg-white border-orange-200" placeholder="Ù…Ø«Ø§Ù„: 1254">
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-orange-500 block mb-1">Ø§Ù„Ø³Ù†Ø©</label>
                            <select id="n-year-case" class="form-input bg-white border-orange-200">
                                <option value="2026">2026</option>
                                <option value="2025">2025</option>
                                <option value="2024">2024</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="form-label">Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</label>
                        <input type="text" id="n-subject" class="form-input" required placeholder="Ù…Ù„Ø®Øµ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹...">
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="form-label">Ø§Ù„Ø¬Ù‡Ø© / Ø§Ù„Ù…ØµØ¯Ø±</label>
                            <input type="text" id="n-source" class="form-input" required>
                        </div>
                        <div>
                            <label class="form-label">Ø§Ù„Ù…ÙƒÙ„Ù Ø¨Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                            <select id="n-assignee" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ù…ÙˆØ¸Ù...</option>
                                </select>
                        </div>
                    </div>

                    <button type="submit" class="btn-submit">
                        <i data-lucide="send" class="w-5 h-5"></i> Ø­ÙØ¸ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙƒÙ„ÙŠÙ
                    </button>
                </form>
            </div>

            <div id="tab-reassign" class="tab-content">
                <div class="text-center py-10 opacity-50">
                    <i data-lucide="users" class="w-12 h-12 mx-auto mb-2 text-slate-300"></i>
                    <p class="text-sm">Ø§Ø®ØªØ± Ù…ÙˆØ¸ÙØ§Ù‹ Ù„Ø¹Ø±Ø¶ Ù…Ù‡Ø§Ù…Ù‡ ÙˆÙ†Ù‚Ù„Ù‡Ø§ Ù„Ù…ÙˆØ¸Ù Ø¢Ø®Ø±</p>
                    <select id="reassign-source" class="form-input mt-4 w-full" onchange="loadEmployeeTasks()">
                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ --</option>
                    </select>
                </div>
                <div id="reassign-results" class="mt-4 space-y-2"></div>
            </div>

            <div id="tab-monitor" class="tab-content">
                <div class="flex gap-2 mb-3">
                    <input type="text" placeholder="Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„ÙˆØ§Ø±Ø¯ Ø£Ùˆ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹..." class="form-input text-sm">
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full monitor-table">
                        <thead><tr><th>#</th><th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th><th>Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
                        <tbody id="monitor-tbody">
                            </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <nav class="bottom-nav lg:hidden">
        <a href="distribution.html" class="b-nav-item">
            <i data-lucide="bar-chart-2" class="w-6 h-6"></i><span>Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª</span>
        </a>
        <a href="admin.html" class="b-nav-item active">
            <i data-lucide="settings-2" class="w-6 h-6"></i><span>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span>
        </a>
        <a href="coordinator.html" class="b-nav-item">
            <i data-lucide="users" class="w-6 h-6"></i><span>Ø§Ù„ØªÙ†Ø³ÙŠÙ‚</span>
        </a>
        <a href="employee.html" class="b-nav-item">
            <i data-lucide="briefcase" class="w-6 h-6"></i><span>Ù…Ù‡Ø§Ù…ÙŠ</span>
        </a>
    </nav>

    <script src="assets/js/config.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
        lucide.createIcons();
        const employees = ["Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯", "Ø³Ø§Ø±Ø© Ø¹Ù„ÙŠ", "Ù…Ø­Ù…ÙˆØ¯ Ø­Ø³Ù†", "Ù†Ø±Ù…ÙŠÙ† ÙƒÙ…Ø§Ù„", "Ø®Ø§Ù„Ø¯ ÙŠÙˆØ³Ù"];

        document.addEventListener('DOMContentLoaded', () => {
            const user = auth.checkAuth();
            if(!user) return;
            if(user.role !== 'admin' && user.role !== 'Ù…Ø¯ÙŠØ±') window.location.href = 'distribution.html';

            document.getElementById('admin-name').textContent = user.name;

            // Ù…Ù„Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            const selects = [document.getElementById('n-assignee'), document.getElementById('reassign-source')];
            selects.forEach(sel => {
                if(sel) {
                    employees.forEach(emp => {
                        sel.innerHTML += `<option value="${emp}">${emp}</option>`;
                    });
                }
            });
        });

        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.getElementById(`btn-${tabId}`).classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
        }

        function toggleLegal() {
            const type = document.getElementById('n-type').value;
            const box = document.getElementById('legal-box');
            if(type === 'Ù†ÙŠØ§Ø¨Ø©') box.classList.remove('hidden');
            else box.classList.add('hidden');
        }

        async function addTask(e) {
            e.preventDefault();
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙƒÙ„ÙŠÙ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
            e.target.reset();
        }
    </script>
</body>
</html>
